<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gerador da Sho - Cupons da Sho</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        /* ESTILO ORIGINAL DO SEU SITE */
        body { background-color: #121212; color: white; font-family: 'Segoe UI', sans-serif; text-align: center; padding: 20px; margin: 0; }
        .container { max-width: 450px; margin: auto; background: #1e1e1e; padding: 25px; border-radius: 25px; box-shadow: 0 10px 30px rgba(0,0,0,0.5); }
        .logo { width: 120px; border-radius: 20px; margin-bottom: 20px; box-shadow: 0 0 15px rgba(255, 77, 45, 0.3); }
        h2 { margin: 10px 0; font-size: 24px; }
        .slogan { color: #888; font-size: 14px; margin-bottom: 25px; }
        
        input { width: 100%; padding: 15px; border-radius: 12px; border: 1px solid #333; margin: 10px 0; background: #2c2c2c; color: white; box-sizing: border-box; font-size: 14px; }
        .btn-gerar { background: linear-gradient(45deg, #ff4d2d, #ff6a00); color: white; padding: 15px; width: 100%; border: none; border-radius: 12px; font-weight: bold; cursor: pointer; font-size: 16px; margin-top: 10px; transition: 0.3s; }
        
        /* BOX DE RESULTADO ORIGINAL */
        .resultado-box { margin-top: 25px; background: #2c2c2c; padding: 20px; border-radius: 15px; border-left: 5px solid #4caf50; text-align: left; }
        .resultado-text { color: #4caf50; font-size: 13px; font-weight: bold; margin-bottom: 10px; display: block; }
        .link-gerado { color: #ff4d2d; font-size: 14px; word-break: break-all; text-decoration: none; display: block; margin-bottom: 20px; }
        .botoes-acao { display: flex; gap: 10px; }
        .btn-acao { flex: 1; padding: 12px; border-radius: 10px; border: none; font-weight: bold; cursor: pointer; font-size: 13px; text-decoration: none; text-align: center; }
        .btn-shopee { background: #ff4d2d; color: white; }
        .btn-copiar { background: #3d3d3d; color: white; }

        /* BOT√ïES DE REDES SOCIAIS ORIGINAIS */
        .social-title { font-size: 12px; color: #666; margin-top: 30px; margin-bottom: 15px; }
        .btn-social { display: flex; align-items: center; justify-content: center; gap: 10px; padding: 12px; border-radius: 15px; text-decoration: none; font-weight: bold; margin-bottom: 10px; font-size: 14px; }
        .btn-tg { background: #0088cc; color: white; }
        .btn-wa { background: #25d366; color: white; }

        /* SE√á√ÉO DE LINKS RECENTES (ESTILO DO SEU PRINT) */
        .recent-container { margin-top: 40px; text-align: left; border-top: 1px solid #333; padding-top: 20px; }
        .recent-title { color: #ff4d2d; font-size: 13px; font-weight: bold; margin-bottom: 15px; text-transform: uppercase; letter-spacing: 1px; }
        .recent-card { background: white; border-radius: 15px; padding: 12px; display: flex; align-items: center; gap: 12px; margin-bottom: 12px; color: #333; }
        .recent-img { width: 65px; height: 65px; border-radius: 10px; object-fit: cover; background: #eee; }
        .recent-info { flex: 1; }
        .recent-info h4 { font-size: 12px; margin: 0 0 8px 0; color: #222; height: 32px; overflow: hidden; line-height: 1.3; }
        .recent-buttons { display: flex; gap: 8px; }
        .btn-card { flex: 1; padding: 7px; border-radius: 8px; font-size: 10px; font-weight: bold; text-align: center; text-decoration: none; }
        .btn-open { background: #fce4ec; color: #d81b60; }
        .btn-coupon { background: #f0f0f0; color: #666; }
    </style>
</head>
<body>
    <div class="container">
        <img src="/static/logo.png" class="logo">
        <h2>Gerador da Sho</h2>
        <p class="slogan">Transforme qualquer produto da Shopee em uma oferta exclusiva Cupons da Sho üß°</p>
        
        <form method="POST">
            <input type="text" name="link_usuario" placeholder="Cole o link do seu produto da Shopee aqui..." required>
            <button type="submit" class="btn-gerar">GERAR LINK COM DESCONTO ‚ö°</button>
        </form>

        {% if link_novo %}
        <div class="resultado-box">
            <span class="resultado-text">‚úÖ Link com desconto gerado com sucesso:</span>
            <a href="{{ link_novo }}" target="_blank" class="link-gerado" id="linkFinal">{{ link_novo }}</a>
            <div class="botoes-acao">
                <a href="{{ link_novo }}" target="_blank" class="btn-acao btn-shopee">ABRIR NA SHOPEE üõçÔ∏è</a>
                <button onclick="copiarTexto()" class="btn-acao btn-copiar">COPIAR LINK</button>
            </div>
        </div>
        {% endif %}

        <p class="social-title">Entre em nossos grupos de cupons gr√°tis:</p>
        <a href="https://t.me/seugrupo" target="_blank" class="btn-social btn-tg">
            <i class="fab fa-telegram"></i> Grupo no Telegram
        </a>
        <a href="https://wa.me/seugrupo" target="_blank" class="btn-social btn-wa">
            <i class="fab fa-whatsapp"></i> Grupo no WhatsApp
        </a>

        <div class="recent-container">
            <h3 class="recent-title"><i class="fas fa-history"></i> LINKS GERADOS RECENTEMENTE</h3>
            <div id="recent-list">
                </div>
        </div>
    </div>

    <script>
        // FUN√á√ÉO DE COPIAR ORIGINAL
        function copiarTexto() {
            const link = document.getElementById('linkFinal').innerText;
            navigator.clipboard.writeText(link).then(() => {
                alert("Link copiado para a √°rea de transfer√™ncia!");
            });
        }

        // L√ìGICA DE HIST√ìRICO
        const KEY = 'shopee_history_v2';

        function saveHistory(link, title, img) {
            let history = JSON.parse(localStorage.getItem(KEY) || "[]");
            history = history.filter(item => item.link !== link);
            history.unshift({ link, title, img: img || '/static/logo.png' });
            localStorage.setItem(KEY, JSON.stringify(history.slice(0, 6)));
            renderHistory();
        }

        function renderHistory() {
            const list = document.getElementById('recent-list');
            const history = JSON.parse(localStorage.getItem(KEY) || "[]");
            list.innerHTML = history.map(item => `
                <div class="recent-card">
                    <img src="${item.img}" class="recent-img" onerror="this.src='/static/logo.png'">
                    <div class="recent-info">
                        <h4>${item.title || 'Produto em Oferta'}</h4>
                        <div class="recent-buttons">
                            <a href="${item.link}" target="_blank" class="btn-card btn-open">Abrir produto</a>
                            <a href="https://s.shopee.com.br/5L6Pa194W6" class="btn-card btn-coupon">Resgate mais cupons</a>
                        </div>
                    </div>
                </div>
            `).join('');
        }

        {% if link_novo %}
            saveHistory("{{ link_novo }}", "{{ titulo }}", "{{ foto }}");
        {% else %}
            renderHistory();
        {% endif %}
    </script>
</body>
</html>
