<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gerador da Sho</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <link rel="icon" type="image/png" href="{{ url_for('static', filename='logo.png') }}">
    
    <style>
        :root {
            --bg-body: #050505;
            --texto-principal: #ffffff;
            --texto-secundario: rgba(255, 255, 255, 0.7);
            --cor-marca: #ee4d2d;
            --glass-shadow: inset 0 2px 3px rgba(255, 255, 255, 0.3), 0 20px 40px rgba(0,0,0,0.4);
            --glass-border: 1px solid rgba(255, 255, 255, 0.2);
            --bg-glass-base: rgba(255, 255, 255, 0.08);
        }

        .light-mode {
            --bg-body: #eef2f6;
            --texto-principal: #1c1c1e;
            --texto-secundario: rgba(0, 0, 0, 0.6);
            --glass-shadow: inset 0 2px 4px rgba(255, 255, 255, 0.9), 0 15px 35px rgba(0,0,0,0.1);
            --glass-border: 1px solid rgba(255, 255, 255, 0.6);
            --bg-glass-base: rgba(255, 255, 255, 0.4);
        }

        body { background-color: var(--bg-body); color: var(--texto-principal); font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif; display: flex; flex-direction: column; align-items: center; min-height: 100vh; margin: 0; padding: 20px 0; transition: 0.5s; overflow-x: hidden; }

        .blob { position: absolute; width: 350px; height: 350px; background: radial-gradient(circle, rgba(238, 77, 45, 0.2) 0%, transparent 70%); filter: blur(60px); border-radius: 50%; z-index: -1; animation: move 18s infinite alternate; }
        @keyframes move { from { transform: translate(-30%, -30%); } to { transform: translate(30%, 30%); } }

        .container { text-align: center; width: 90%; max-width: 400px; padding: 25px; border-radius: 45px; background: var(--bg-glass-base); box-shadow: var(--glass-shadow); border: var(--glass-border); backdrop-filter: blur(30px); -webkit-backdrop-filter: blur(30px); position: relative; margin-bottom: 25px; }
        
        .theme-toggle { position: absolute; top: 25px; right: 25px; cursor: pointer; color: var(--texto-secundario); font-size: 20px; }
        .logo { width: 100px; border-radius: 25%; margin-bottom: 10px; }
        h1 { margin: 0 0 5px 0; font-size: 26px; font-weight: 800; letter-spacing: -1px; }
        .subtexto { color: var(--texto-secundario); font-size: 14px; margin-bottom: 25px; }
        
        input { width: 100%; padding: 18px 25px; margin-bottom: 12px; border-radius: 50px; background: rgba(255,255,255,0.05); color: var(--texto-principal); border: 1px solid rgba(255,255,255,0.1); box-sizing: border-box; font-size: 16px; outline: none; }
        .light-mode input { background: rgba(0,0,0,0.04); }
        
        .btn-gerar { width: 100%; padding: 18px; margin-bottom: 10px; border-radius: 50px; border: none; background: linear-gradient(170deg, #ff7a59, #ee4d2d); color: white; font-weight: 800; cursor: pointer; font-size: 17px; box-shadow: 0 10px 20px rgba(238, 77, 45, 0.3); transition: 0.3s; }
        .btn-gerar:active { transform: scale(0.97); }

        /* --- RANKING DE √öLTIMOS PRODUTOS --- */
        .ranking-container { width: 90%; max-width: 400px; text-align: left; }
        .ranking-titulo { font-weight: 800; font-size: 19px; margin: 25px 0 15px 15px; display: block; letter-spacing: -0.5px; }
        
        .ranking-card { 
            display: flex; align-items: center; gap: 15px; padding: 15px; border-radius: 35px; 
            background: var(--bg-glass-base); border: var(--glass-border); backdrop-filter: blur(20px);
            box-shadow: var(--glass-shadow); margin-bottom: 15px; animation: slideIn 0.5s ease-out;
        }
        @keyframes slideIn { from { opacity: 0; transform: translateY(15px); } to { opacity: 1; transform: translateY(0); } }

        .prod-img { width: 70px; height: 70px; border-radius: 20px; object-fit: cover; background: #fff; border: 1px solid rgba(255,255,255,0.1); }
        .prod-info { flex: 1; overflow: hidden; }
        .prod-nome { font-size: 14px; font-weight: 700; margin: 0 0 10px 0; color: var(--texto-principal); line-height: 1.3; overflow: hidden; text-overflow: ellipsis; display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical; }
        
        .prod-botoes { display: flex; gap: 10px; align-items: center; }
        .link-ir { font-size: 12px; color: var(--cor-marca); text-decoration: none; font-weight: 800; }
        .btn-resgate { font-size: 11px; background: var(--cor-marca); color: white; padding: 6px 14px; border-radius: 50px; text-decoration: none; font-weight: 900; text-transform: uppercase; box-shadow: 0 5px 10px rgba(238, 77, 45, 0.2); }

        .resultado { margin-top: 20px; padding: 25px; border-radius: 35px; background: rgba(255,255,255,0.05); border: var(--glass-border); box-shadow: var(--glass-shadow); }
        .sucesso-titulo { color: #30d158; font-weight: 800; font-size: 17px; display: block; margin-bottom: 12px; }
        .link-text { color: var(--cor-marca); font-weight: 700; word-break: break-all; font-size: 15px; display: block; margin-bottom: 20px; }
        .btn-acao { display: flex; gap: 12px; }
        .btn-acao * { flex: 1; padding: 14px; border-radius: 50px; border: none; font-weight: 800; font-size: 13px; text-align: center; cursor: pointer; text-decoration: none; background: rgba(255,255,255,0.1); color: var(--texto-principal); box-shadow: inset 0 1px 2px rgba(255,255,255,0.2); }
        .btn-abrir { background: var(--cor-marca) !important; color: white !important; }

        .canais-section { margin-top: 30px; padding: 20px; width: 100%; border-top: 1px solid rgba(255,255,255,0.1); }
        .btn-social { width: 100%; max-width: 320px; padding: 14px; border-radius: 50px; display: flex; align-items: center; justify-content: center; gap: 10px; font-weight: 800; color: white !important; text-decoration: none; margin: 0 auto 12px auto; font-size: 15px; }
        .btn-tg { background: #0088cc; } .btn-wa { background: #34c759; }

        #avisoCopiado { visibility: hidden; background: rgba(48, 209, 88, 0.9); color: white; border-radius: 50px; padding: 12px 30px; position: fixed; bottom: 35px; font-weight: 800; z-index: 100; backdrop-filter: blur(10px); }
        #avisoCopiado.show { visibility: visible; animation: fadeinout 2s; }
        @keyframes fadeinout { 0%, 100% { opacity: 0; transform: scale(0.9); } 20%, 80% { opacity: 1; transform: scale(1); } }
    </style>
</head>
<body>
    <div class="blob" style="top: 5%; left: 15%;"></div>
    
    <div class="container">
        <div class="theme-toggle" onclick="toggleTheme()"><i id="theme-icon" class="fas fa-sun"></i></div>
        <img src="{{ url_for('static', filename='logo.png') }}" class="logo">
        <h1>Gerador da Sho</h1>
        <p class="subtexto">Produtos exclusivos Cupons da Sho üß°</p>

        <form method="POST">
            <input type="text" name="link_usuario" placeholder="Cole seu link aqui..." required autocomplete="off">
            <button type="submit" class="btn-gerar">{% if link_novo %} GERAR OUTRO DESCONTO ‚ö° {% else %} GERAR LINK COM DESCONTO ‚ö° {% endif %}</button>
        </form>

        {% if link_novo %}
            <div class="resultado">
                <span class="sucesso-titulo">‚úÖ Link gerado com sucesso!</span>
                <span class="link-text" id="meuLink">{{ link_novo }}</span>
                <div class="btn-acao">
                    <a href="{{ link_novo }}" target="_blank" class="btn-abrir">ABRIR üõçÔ∏è</a>
                    <button onclick="copiarLink()">COPIAR</button>
                </div>
            </div>
        {% endif %}
    </div>

    {% if ranking %}
    <div class="ranking-container">
        <span class="ranking-titulo">√öltimos links gerados üíé</span>
        {% for item in ranking %}
        <div class="ranking-card">
            <img src="{{ item.imagem }}" class="prod-img">
            <div class="prod-info">
                <p class="prod-nome">{{ item.titulo }}</p>
                <div class="prod-botoes">
                    <a href="{{ item.link }}" target="_blank" class="link-ir">Ir para o produto</a>
                    <a href="{{ item.link }}" target="_blank" class="btn-resgate">Resgate</a>
                </div>
            </div>
        </div>
        {% endfor %}
    </div>
    {% endif %}

    <div class="canais-section">
        <a href="https://t.me/cuponsdasho" target="_blank" class="btn-social btn-tg">Telegram</a>
        <a href="https://whatsapp.com/channel/0029VaGaBZj5vKACU9lGcr1A" target="_blank" class="btn-social btn-wa">WhatsApp</a>
    </div>

    <div id="avisoCopiado">Link Copiado! ‚úîÔ∏è</div>

    <script>
        function toggleTheme() {
            const body = document.body;
            const icon = document.getElementById('theme-icon');
            body.classList.toggle('light-mode');
            if (body.classList.contains('light-mode')) {
                icon.classList.replace('fa-sun', 'fa-moon');
                localStorage.setItem('theme', 'light');
            } else {
                icon.classList.replace('fa-moon', 'fa-sun');
                localStorage.setItem('theme', 'dark');
            }
        }
        window.onload = () => {
            const savedTheme = localStorage.getItem('theme');
            if (savedTheme === 'light') {
                document.body.classList.add('light-mode');
                document.getElementById('theme-icon').classList.replace('fa-sun', 'fa-moon');
            }
        }
        function copiarLink() {
            const texto = document.getElementById('meuLink').innerText;
            const inputTemporario = document.createElement("textarea");
            inputTemporario.value = texto;
            document.body.appendChild(inputTemporario);
            inputTemporario.select();
            document.execCommand("copy");
            document.body.removeChild(inputTemporario);
            const x = document.getElementById("avisoCopiado");
            x.className = "show";
            setTimeout(function(){ x.className = x.className.replace("show", ""); }, 2000);
        }
    </script>
</body>
</html>
